---
module: cockroachdb_db
short_description: Manage CockroachDB databases
description:
  - Create, drop, or manage CockroachDB databases
options:
  name:
    description:
      - Name of the database to create or remove
    required: true
    type: str
  state:
    description:
      - The database state
    default: present
    choices: ["present", "absent"]
    type: str
  host:
    description:
      - Database host address
    default: localhost
    type: str
  port:
    description:
      - Database port number
    default: 26257
    type: int
  user:
    description:
      - Database username
    default: root
    type: str
  password:
    description:
      - Database user password
    type: str
  ssl_mode:
    description:
      - SSL connection mode
    default: verify-full
    choices: ["disable", "allow", "prefer", "require", "verify-ca", "verify-full"]
    type: str
  ssl_cert:
    description:
      - Path to client certificate file
    type: path
  ssl_key:
    description:
      - Path to client private key file
    type: path
  ssl_rootcert:
    description:
      - Path to CA certificate file
    type: path
  owner:
    description:
      - Name of the role to set as owner of the database
    type: str
requirements:
  - psycopg2
author:
  - "Ryan Punt (@rpunt)"


examples: |
  # Create a new CockroachDB database
  - name: Create a new database
    cockroachdb_db:
      name: mydatabase
      state: present
      host: localhost
      port: 26257
      user: root
      ssl_cert: /path/to/client.crt
      ssl_key: /path/to/client.key
      ssl_rootcert: /path/to/ca.crt

  # Drop a database
  - name: Drop database
    cockroachdb_db:
      name: mydatabase
      state: absent
      host: localhost
      user: root
      ssl_cert: /path/to/client.crt
      ssl_key: /path/to/client.key
      ssl_rootcert: /path/to/ca.crt


return_values:
  name:
    description: Name of the database
    returned: always
    type: str
    sample: "mydatabase"
  state:
    description: The new state of the database
    returned: always
    type: str
    sample: "present"
  changed:
    description: Whether the database was changed
    returned: always
    type: bool
    sample: true
